%#============================================================================
%# ePortal - WEB Based daily organizer
%# Author - S.Rusakov <rusakov_sa@users.sourceforge.net>
%#
%# Copyright (c) 2001 Sergey Rusakov.  All rights reserved.
%# This program is free software; you can redistribute it
%# and/or modify it under the same terms as Perl itself.
%#
%# $Revision: 3.1 $
%# $Date: 2003/04/24 05:36:52 $
%# $Header: /home/cvsroot/ePortal/comp_root/catalog/link_edit_type.htm,v 3.1 2003/04/24 05:36:52 ras Exp $
%#
%#----------------------------------------------------------------------------
<& /message.mc &>
&nbsp;
<% $dlg->dialog_start(
    title => pick_lang(rus => "Тип ссылки на ресурс", eng => "Resource type"),
    width => 300) %>

<% $dlg->field( "parent_id", hidden => 1)  %>
<% $dlg->field( "recordtype") %>
<% $dlg->row('&nbsp;') %>
<% $dlg->buttons( ok_label => pick_lang(rus => 'Дальше >>>', eng => 'Next >>>')) %>
<% $dlg->dialog_end %>
<p>

<& SELF:dialog_help &>

%#=== @METAGS attr =========================================================
<%attr>
Title => {rus => "Тип ссылки на ресурс", eng => "Link type"}
</%attr>


%#=== @METAGS onStartRequest ====================================================
<%method onStartRequest><%perl>
  $obj = new ePortal::ThePersistent::Session;
  $obj->add_attribute(recordtype => $ePortal::Catalog::attributes->{recordtype});
  $obj->add_attribute(parent_id => $ePortal::Catalog::attributes->{parent_id});

  $obj->restore( $ENV{SCRIPT_NAME} );
  $obj->parent_id( $ARGS{parent_id} ) if $ARGS{parent_id};

  $dlg = new ePortal::HTML::Dialog( obj => $obj);

  my $location = $dlg->handle_request();
  if ( $dlg->isButtonPressed('ok') ) {

    if ( $obj->RecordType eq 'group' ) {
      return href("group_edit.htm",
        objid => 0,
        parent_id => $obj->parent_id,
        back_url => $location);

    } else {
      return href("link_edit.htm",
          objid => 0,
          recordtype => $obj->RecordType,
          parent_id => $obj->parent_id,
          back_url => $location);
    }

  } elsif ($location) { # Cancel pressed
    return $location;
  }

</%perl></%method>



%#=== @METAGS dialog_help ====================================================
<%method dialog_help>
<b><% pick_lang(rus => "Выбор типа ресурса", eng => "Choose resource type") %></b>
<ul>
<li><b><% pick_lang(rus => "Ссылка", eng => "Link") %></b>
  - <% pick_lang(
      rus => "Ссылка на другую страницу сервера",
      eng => "Link to another page") %>

<li><b><% pick_lang(rus => "Текст как есть", eng => "Preformatted text") %></b>
  - <% pick_lang(
      rus => "Текст выводится без форматирования. <PRE>",
      eng => "This text is preformatted with <PRE>") |h %>

<li><b><% pick_lang(rus => "Текст HTML", eng => "HTML text") %></b>
  - <% pick_lang(
      rus => "Текст HTML выводится без изменений",
      eng => "HTML text is shown unchanged") %>

<li><b><% pick_lang(rus => "Текст по параграфам", eng => "Text with paragraphs") %></b>
  - <% pick_lang(
      rus => "Для разделения параграфов используется пустая строка",
      eng => "Empty line is paragraph separator") %>

<li><b><% pick_lang(rus => "Строка это параграф", eng => "A line is paragraph") %></b>
  - <% pick_lang(
      rus => "Одна строка текста - это параграф",
      eng => "Every line of text is a paragraph") %>

</ul>
</%method>


%#=== @metags once =========================================================
<%once>
my ($dlg, $obj);
</%once>

%#=== @metags cleanup =========================================================
<%cleanup>
($dlg, $obj) = ();
</%cleanup>

