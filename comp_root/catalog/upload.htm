%#============================================================================
%# ePortal - WEB Based daily organizer
%# Author - S.Rusakov <rusakov_sa@users.sourceforge.net>
%#
%# Copyright (c) 2000-2003 Sergey Rusakov.  All rights reserved.
%# This program is free software; you can redistribute it
%# and/or modify it under the same terms as Perl itself.
%#
%#----------------------------------------------------------------------------

%#=== @metags onStartRequest ====================================================
<%method onStartRequest><%perl>
  my $catalog_id = $ARGS{objid};
  my $C = new ePortal::Catalog;
  if ( $C->restore($catalog_id) ) {
    my $new_att = new ePortal::Attachment;
    if ( $new_att->upload(r => $r) ) {
      $new_att->link_with_object($C);
    }  
  }

  return $m->comp('/dialog.mc:back_url');
</%perl></%method>
