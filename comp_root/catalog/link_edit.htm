%#============================================================================
%# ePortal - WEB Based daily organizer
%# Author - S.Rusakov <rusakov_sa@users.sourceforge.net>
%#
%# Copyright (c) 2001 Sergey Rusakov.  All rights reserved.
%# This program is free software; you can redistribute it
%# and/or modify it under the same terms as Perl itself.
%#
%# $Revision: 3.2 $
%# $Date: 2003/04/24 05:36:52 $
%# $Header: /home/cvsroot/ePortal/comp_root/catalog/link_edit.htm,v 3.2 2003/04/24 05:36:52 ras Exp $
%#
%#----------------------------------------------------------------------------

&nbsp;
<% $dlg->dialog_start(
    title => pick_lang(rus => "Ссылка на ресурс", eng => "Link to resource"),
    width => 550) %>

<% $dlg->field( "recordtype") %>
<% $dlg->row('<hr>') %>
<% $dlg->field( "parent_id")  %>
<% $dlg->field( "title" ) %>
<% $dlg->field( "nickname" ) %>
<% $dlg->field( "priority" ) %>
<% $dlg->row('<hr>') %>

% if ($obj->RecordType eq 'link') {
  <% $dlg->field( "url" ) %>

% } elsif ($obj->RecordType =~ /^text/) {
  <% $dlg->field( "text" ) %>

% } elsif ($obj->RecordType eq 'file') {
  <% $dlg->row(pick_lang(rus => "Загружен файл", eng => "Loaded file"),
      $obj->htmlValue('filename') . '&nbsp;' .
      length($obj->Text) . '&nbsp;' .
      pick_lang(rus => "байт", eng => "bytes")
      )%>
  <% $dlg->field( "upload_file" ) %>
% }

<% $dlg->row('<hr>') %>
<% $dlg->field( "memo" ) %>
<% $dlg->field( "ts", RO => 1 ) %>
<% $dlg->field( "Clicks", RO => 1 ) %>
<% $dlg->field( "Hits", RO => 1 ) %>
% if ($obj->xacl_check_admin) {
  <% $dlg->row( "<hr>" ) %>
  <% $dlg->field( "xacl_read" ) %>
  <% $dlg->field( "xacl_write" ) %>
  <% $dlg->field( "xacl_admin" ) %>
% }
<% $dlg->row('&nbsp;') %>
<% $dlg->buttons( delete_button => 1 ) %>
<% $dlg->dialog_end %>
<p>

<& link_edit_type.htm:dialog_help &>

%#=== @METAGS attr =========================================================
<%attr>
Title => {rus => "Ссылка на ресурс", eng => "Link to resource"}
</%attr>


%#=== @METAGS onStartRequest ====================================================
<%method onStartRequest><%perl>
  $obj = new ePortal::Catalog;
  $dlg = new ePortal::HTML::Dialog( obj => $obj, multipart_form => 1);

  # file uploads is done internally by ePortal::Calatlog::htmlSave
	my $location = $dlg->handle_request();
  return $location if $location;

  $obj->parent_id( $ARGS{parent_id} ) if defined $ARGS{parent_id};
  $obj->RecordType( $ARGS{recordtype} ) if defined $ARGS{recordtype};
</%perl></%method>




%#=== @metags once =========================================================
<%once>
my ($dlg, $obj);
</%once>

%#=== @metags cleanup =========================================================
<%cleanup>
($dlg, $obj) = ();
</%cleanup>

