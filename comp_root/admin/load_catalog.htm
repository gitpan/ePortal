%#============================================================================
%# ePortal - WEB Based daily organizer
%# Author - S.Rusakov <rusakov_sa@users.sourceforge.net>
%#
%# Copyright (c) 2001 Sergey Rusakov.  All rights reserved.
%# This program is free software; you can redistribute it
%# and/or modify it under the same terms as Perl itself.
%#
%# $Revision: 3.2 $
%# $Date: 2003/04/24 05:36:51 $
%# $Header: /home/cvsroot/ePortal/comp_root/admin/load_catalog.htm,v 3.2 2003/04/24 05:36:51 ras Exp $
%#
%#----------------------------------------------------------------------------

% my $CATALOG = $ARGS{CATALOG};
% my %args = $m->request_args;

<p>
<& /item_caption.mc, title => pick_lang(rus => "Загрузка Каталога", eng => "Catalogue loading") &>
<p>
<%perl>

  my $C = new ePortal::Catalog;
  foreach my $cat (@$CATALOG) {
    if ( $args{DOIT} ) {
      $C->AddCatalogItem(%$cat);
      $m->print( '<p>' . pick_lang(rus => "Добавляется ", eng => "Adding "));
      $m->print("<b>$cat->{nickname}</b> =>");
      $m->print( plink($cat->{title}, -href => href('/catalog/index.htm', group => $cat->{nickname})));
    } else {
      $m->print( '<p>' . pick_lang(rus => "Будет добавлен ", eng => "To be added "));
      $m->print("<b>$cat->{nickname}</b> =>");
      $m->print( plink($cat->{title}, -href => href('/catalog/index.htm', group => $cat->{nickname})));
    }
  }
</%perl>

% if ($args{DOIT} ) {
  <& /message.mc, GoodMessage => pick_lang(
      rus => "Сохранено ".scalar(@$CATALOG) . " элементов в каталог",
      eng => "Saved ".scalar(@$CATALOG)." items into catalogue") &>
% } else {
  <center>
  <hr>
  <b>
  <% plink( pick_lang(rus => "Нажмите сюда чтобы внести изменения в Каталог",
    eng => "Click here to add items to Catalogue"),
    -href => href($ENV{SCRIPT_NAME}, %args, DOIT=>1) ) %>...
  </b>
  <hr>
  </center>
% }


<p>
<% plink( pick_lang(rus => "Обратно на страницу администратора", eng => "Back to admin home page"), -href => 'index.htm') %>
<p>
