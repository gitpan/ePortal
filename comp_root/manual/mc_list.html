<HTML>
<HEAD>
<TITLE>list.mc - List of something as HTML table</TITLE>
<LINK REV="made" HREF="mailto:rusakov_sa@users.sourceforge.net">
</HEAD>

<BODY>

<A NAME="__index__"></A>
<!-- INDEX BEGIN -->

<UL>

	<LI><A HREF="#name">NAME</A></LI>
	<LI><A HREF="#synopsis">SYNOPSIS</A></LI>
	<LI><A HREF="#parameters">PARAMETERS</A></LI>
	<LI><A HREF="#methods">METHODS</A></LI>
	<UL>

		<LI><A HREF="#row">row</A></LI>
		<LI><A HREF="#extra_row">extra_row</A></LI>
		<LI><A HREF="#row_span">row_span</A></LI>
		<LI><A HREF="#action_bar">action_bar</A></LI>
		<LI><A HREF="#checkboxes">checkboxes</A></LI>
		<LI><A HREF="#list_action">list_action</A></LI>
		<LI><A HREF="#column">column</A></LI>
		<LI><A HREF="#column_image">column_image</A></LI>
		<LI><A HREF="#column_delete">column_delete</A></LI>
		<LI><A HREF="#column_edit">column_edit</A></LI>
		<LI><A HREF="#column_checkbox">column_checkbox</A></LI>
		<LI><A HREF="#column_number">column_number</A></LI>
		<LI><A HREF="#state">state</A></LI>
		<LI><A HREF="#self_url">self_url</A></LI>
		<LI><A HREF="#state_as_hidden">state_as_hidden</A></LI>
		<LI><A HREF="#before_title%2Cafter_title%2Cbefore_">before_title,after_title,before_footer,after_footer</A></LI>
		<LI><A HREF="#nodata">nodata</A></LI>
	</UL>

	<LI><A HREF="#request%20arguments">REQUEST ARGUMENTS</A></LI>
	<LI><A HREF="#author">AUTHOR</A></LI>
</UL>
<!-- INDEX END -->

<HR>
<P>
<H1><A NAME="name">NAME</A></H1>
<P>list.mc - List of something as HTML table</P>
<P>
<HR>
<H1><A NAME="synopsis">SYNOPSIS</A></H1>
<P>This Mason component replaces absoleted ePortal::HTML::List package.</P>
<P>It is used to create HTML tables for iterable objects and arrays.</P>
<PRE>
 &lt;&amp;| /list.mc, id=&gt;'list1', obj =&gt; $object OR  list =&gt; [@array] &amp;&gt;</PRE>
<PRE>
  &lt;&amp;| /list.mc:row, parameters &amp;&gt;   # this method is optional
    &lt;&amp; /list.mc:column, parameters &amp;&gt;
    &lt;&amp; /list.mc:column_image, src =&gt; ... &amp;&gt;
  &lt;/&amp;&gt; # end of row
  &lt;&amp;| /list.mc:extra_row &amp;&gt;
     ...
  &lt;/&amp;&gt;</PRE>
<PRE>
  # These method going after all &quot;column&quot; methods
  &lt;&amp;| /list.mc:before_title &amp;&gt; ...  &lt;/&amp;&gt;
  &lt;&amp;| /list.mc:after_title &amp;&gt; ...  &lt;/&amp;&gt;
  &lt;&amp;| /list.mc:before_footer &amp;&gt; ...  &lt;/&amp;&gt;
  &lt;&amp;| /list.mc:after_footer &amp;&gt; ...  &lt;/&amp;&gt;</PRE>
<PRE>
  &lt;&amp;  /list.mc:row_span &amp;&gt;
 &lt;/&amp;&gt; # end of list</PRE>
<P>The typical list consists of the following:</P>
<PRE>
 &lt;table&gt;
  &lt;form&gt;</PRE>
<PRE>
   &lt;before_title row&gt;
   &lt;title row&gt;
   &lt;after_title row&gt;</PRE>
<PRE>
     &lt;one or more rows&gt;
      &lt;extra_row for each row&gt;</PRE>
<PRE>
   &lt;before_footer row&gt;
   &lt;footer row&gt;
   &lt;action_bar row&gt;
   &lt;after_footer row&gt;</PRE>
<PRE>
  &lt;/form&gt;
 &lt;/table&gt;</PRE>
<P>The content of &lt;&amp;| list.mc &amp;&gt; is responsible for HTML generation of each row.</P>
<P>The very first call to content is when row_number==0. This call is used to
count all columns, create soring groups and discover column titles.
ThePersistent object is not restored at this moment and $_ is undefined for
array lists.</P>
<P>Use local variable <CODE>$_</CODE> as iterator for array. $_ is the object for
ThePersistent lists.</P>
<P>
<HR>
<H1><A NAME="parameters">PARAMETERS</A></H1>
<P>All -xxx like parameters are passed directly to CGI::start_table. Others are</P>
<UL>
<LI><STRONG><A NAME="item_id">id</A></STRONG><BR>

The ID of the list. Used for submit forms and when more then 1 list exists on
page.
<P></P>
<LI><STRONG><A NAME="item_submit">submit</A></STRONG><BR>

Make HTML form inside the list.
<P></P>
<LI><STRONG><A NAME="item_no_title">no_title</A></STRONG><BR>

Do not produce title row
<P></P>
<LI><STRONG><A NAME="item_no_footer">no_footer</A></STRONG><BR>

<UL>
<LI><STRONG><A NAME="item_%253D%253D1">==1</A></STRONG><BR>

Do not produce footer row any case
<P></P>
<LI><STRONG><A NAME="item_%253D%253D2">==2</A></STRONG><BR>

Show footer row if there is more than one page to display
<P></P></UL>
<LI><STRONG><A NAME="item_order_by">order_by</A></STRONG><BR>

ID of column to order by this column by default or ``!ID'' string to order by
descending.
<P></P></UL>
<P>
<HR>
<H1><A NAME="methods">METHODS</A></H1>
<P>
<H2><A NAME="row">row</A></H2>
<P>Generic method to make a row. Call once per list content. Use
<A HREF="#extra_row">extra_row</A> method if you need more than one row per iteration.</P>
<P>This is optionsl method. list.mc call it implicitly at least once if you don't.</P>
<PRE>
 &lt;&amp;| /list.mc:row &amp;&gt;
  &lt;&amp; /list.mc:column &amp;&gt;
  ...
 &lt;/&amp;&gt;</PRE>
<PRE>
 &lt;&amp;| /list.mc:extra_row &amp;&gt;
  this is additional row
 &lt;/&amp;&gt;</PRE>
<UL>
<LI><STRONG><A NAME="item_%252Dxxx">-xxx</A></STRONG><BR>

All parameters starting with '-' are passed to CGI::Tr() function.
<P></P></UL>
<P>
<H2><A NAME="extra_row">extra_row</A></H2>
<P>Produce ``extra'' row in the same style as main row. Used for description and
memos</P>
<UL>
<LI><STRONG><A NAME="item_start_column">start_column</A></STRONG><BR>

By default extra_row is a td with all columns colspan. <A HREF="#item_start_column"><CODE>start_column</CODE></A>
specifies starting column to make colspan
<P></P>
<LI><STRONG><A NAME="item_tr">tr</A></STRONG><BR>

Parameters hash to pass to CGI::Tr() function
<P></P>
<LI><STRONG><A NAME="item_td">td</A></STRONG><BR>

Parameters hash to pass to CGI::td() function
<P></P>
<LI><STRONG>-xxx</STRONG><BR>

All parameters starting with '-' treated as parameters for td
<P></P>
<LI><STRONG><A NAME="item_content">content</A></STRONG><BR>

The content of extra row. You may use &lt;&amp;|&gt; call instead of it.
<P></P></UL>
<P>
<H2><A NAME="row_span">row_span</A></H2>
<P>Make a space between rows.</P>
<PRE>
 &lt;&amp;| list.mc:row &amp;&gt;
  ...
 &lt;/&amp;&gt;
 &lt;&amp; list.mc:row_span &amp;&gt;</PRE>
<UL>
<LI><STRONG><A NAME="item_height">height</A></STRONG><BR>

Height of free space in pixels
<P></P></UL>
<P>
<H2><A NAME="action_bar">action_bar</A></H2>
<P>Action bar below footer consists of two cells. Left is your content and right
is popup_menu with submit button. The name of popup_menu is <STRONG>list_action</STRONG>.
You may get it with <A HREF="#list_action">list_action</A> method or as $ARGS{list_action}.</P>
<P>Array of ID of selected checkboxes available with <A HREF="#checkboxes">checkboxes</A> method.</P>
<UL>
<LI><STRONG>content</STRONG><BR>

The content of left cell. You may use &lt;&amp;|&gt; call instead of it.
<P></P>
<LI><STRONG>td</STRONG><BR>

Parameters hash for left CGI::td() function
<P></P>
<LI><STRONG><A NAME="item_popup_menu">popup_menu</A></STRONG><BR>

Parameters hash for popup_menu
<P></P>
<LI><STRONG><A NAME="item_button">button</A></STRONG><BR>

Optional parameters hash for submit button. Defaults are enough.
<P></P>
<LI><STRONG><A NAME="item_label">label</A></STRONG><BR>

A label for popup_menu. Default is ``Selected items:''
<P></P></UL>
<P>
<H2><A NAME="checkboxes">checkboxes</A></H2>
<P>Returns array ID of checked checkboxes or empty array.</P>
<P>
<H2><A NAME="list_action">list_action</A></H2>
<P>Returns a value of list_action popup_menu or undef if form was not submitted.
The fact of submit is request method eq 'POST'.</P>
<P>
<H2><A NAME="column">column</A></H2>
<P>Generic method to make a column. Call it as many times as many columns you
have. Place the calls inside <CODE>row</CODE> method.</P>
<UL>
<LI><STRONG>id</STRONG><BR>

ID of the column. Also act as field name for Persistent objects
<P></P>
<LI><STRONG><A NAME="item_title">title</A></STRONG><BR>

Column title
<P></P>
<LI><STRONG><A NAME="item_a">a</A></STRONG><BR>

Hashref of arguments for CGI::a().
<P></P>
<LI><STRONG><A NAME="item_url">url</A></STRONG><BR>

More short way to say a =&gt; {-href =&gt; ...}
<P></P>
<LI><STRONG><A NAME="item_self_url">self_url</A></STRONG><BR>

Hashref of parameters to cunstruct self referencing URL. These parameters
will be replaced with given values.
<P>A special parameter '#' =&gt; ... will be added as URL anchor</P>
<P></P>
<LI><STRONG>-xxx</STRONG><BR>

All parameters like -xxx are passed to CGI::td() function.
<P></P>
<LI><STRONG>order_by</STRONG><BR>

Order By clause of SQL query when sort is on by this column. <A HREF="#item_id"><CODE>id</CODE></A> column
parameter is required if you use <A HREF="#item_order_by"><CODE>order_by</CODE></A> of <A HREF="#item_order_by_desc"><CODE>order_by_desc</CODE></A> feature.
<P></P>
<LI><STRONG><A NAME="item_order_by_desc">order_by_desc</A></STRONG><BR>

Descending sorting for this column. By default is ``<A HREF="#item_order_by">order_by</A> DESC''.
<P></P></UL>
<P>
<H2><A NAME="column_image">column_image</A></H2>
<P>A column with image.</P>
<UL>
<LI><STRONG><A NAME="item_src">src</A></STRONG><BR>

Path to image. Default is <CODE>/images/icons/msg.gif</CODE>
<P></P></UL>
<P>
<H2><A NAME="column_delete">column_delete</A></H2>
<P>Produce delete button.</P>
<UL>
<LI><STRONG>url</STRONG><BR>

Optional URL for delete action.
<P></P>
<LI><STRONG><A NAME="item_objid">objid</A></STRONG><BR>

Optional object id for delete.htm. Default is ID of current object.
<P></P>
<LI><STRONG><A NAME="item_objtype">objtype</A></STRONG><BR>

Reference type of object to delete. Default is ref of current object.
<P></P></UL>
<P>
<H2><A NAME="column_edit">column_edit</A></H2>
<P>Produce ``edit object'' button.</P>
<UL>
<LI><STRONG>url</STRONG><BR>

URL for edit action.
<P></P>
<LI><STRONG>objid</STRONG><BR>

Optional object id of object to edit. Default is ID of current object.
<P></P></UL>
<P>
<H2><A NAME="column_checkbox">column_checkbox</A></H2>
<P>Produce checkbox column</P>
<UL>
<LI><STRONG><A NAME="item_value">value</A></STRONG><BR>

The value of checkbox. Default is array element or object ID
<P></P>
<LI><STRONG><A NAME="item_name">name</A></STRONG><BR>

Name of checkbox field. Default is <CODE>list_chboxLISTID</CODE>
<P></P></UL>
<P>
<H2><A NAME="column_number">column_number</A></H2>
<P>Row number counter</P>
<P>
<H2><A NAME="state">state</A></H2>
<P>Returns HASH of arguments that represent current state of the list. Put these
parameters to other forms on the page to save list apperance untouched.</P>
<UL>
<LI><STRONG>id</STRONG><BR>

ID of list
<P></P></UL>
<P>
<H2><A NAME="self_url">self_url</A></H2>
<P>Return self referencing URL without checkboxes selected.</P>
<P>
<H2><A NAME="state_as_hidden">state_as_hidden</A></H2>
<P>Put list state as hidden fields into your form</P>
<P>
<H2><A NAME="before_title%2Cafter_title%2Cbefore_">before_title,after_title,before_footer,after_footer</A></H2>
<P>This method used to insert a text before|after title|footer row. Place it AFTER all
<CODE>column</CODE> methods. The content of method method is placed into one
wide TD cell. Arguments are:</P>
<PRE>
 &lt;&amp;| /list.mc:before_title &amp;&gt;
  this text goes before title row
 &lt;/&amp;&gt;</PRE>
<P>
<H2><A NAME="nodata">nodata</A></H2>
<P>What to show when no data available in recordset?</P>
<UL>
<LI><STRONG>content</STRONG><BR>

The content of warning
<P></P></UL>
<P>
<HR>
<H1><A NAME="request%20arguments">REQUEST ARGUMENTS</A></H1>
<P>These arguments are significant for list.mc when exists in request. See
<A HREF="#state">state</A> method for convenient way to get hash of all of them.</P>
<UL>
<LI><STRONG><A NAME="item_rowsLISTID">rowsLISTID</A></STRONG><BR>

Rows per page for LISTID list.
<P></P>
<LI><STRONG><A NAME="item_pageLISTID">pageLISTID</A></STRONG><BR>

Page number to display for LISTID list.
<P></P>
<LI><STRONG><A NAME="item_order_byLISTID">order_byLISTID</A></STRONG><BR>

Sort order internal variable. This is id of column to sort ascending or !id
to sort descending.
<P></P></UL>
<P>
<HR>
<H1><A NAME="author">AUTHOR</A></H1>
<P>Sergey Rusakov, &lt;<A HREF="mailto:rusakov_sa@users.sourceforge.net">rusakov_sa@users.sourceforge.net</A>&gt;</P>

</BODY>

</HTML>
