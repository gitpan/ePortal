<HTML>
<HEAD>
<TITLE>ePortal::PageView - Custom home page of ePortal.</TITLE>
<LINK REV="made" HREF="mailto:rusakov_sa@users.sourceforge.net">
</HEAD>

<BODY>

<A NAME="__index__"></A>
<!-- INDEX BEGIN -->

<UL>

	<LI><A HREF="#name">NAME</A></LI>
	<LI><A HREF="#synopsis">SYNOPSIS</A></LI>
	<LI><A HREF="#methods">METHODS</A></LI>
	<UL>

		<LI><A HREF="#restore%28id%29"><CODE>restore(id)</CODE></A></LI>
		<LI><A HREF="#restore_all_templates%28%29"><CODE>restore_all_templates()</CODE></A></LI>
		<LI><A HREF="#restore_all_for_user%28username%29"><CODE>restore_all_for_user(username)</CODE></A></LI>
		<LI><A HREF="#columnscount%28%29"><CODE>ColumnsCount()</CODE></A></LI>
		<LI><A HREF="#columnswidthpercent%28%29"><CODE>ColumnsWidthPercent()</CODE></A></LI>
		<LI><A HREF="#availablesections%28column_number%29"><CODE>AvailableSections(column_number)</CODE></A></LI>
		<LI><A HREF="#get_usersection%28%24column%29"><CODE>get_UserSection($column)</CODE></A></LI>
		<LI><A HREF="#copyfrom%28%24template_id%29"><CODE>CopyFrom($template_id)</CODE></A></LI>
		<LI><A HREF="#setdefaultpageview%28%24new_id%29"><CODE>SetDefaultPageView($new_id)</CODE></A></LI>
		<LI><A HREF="#handle_request%28%29"><CODE>handle_request()</CODE></A></LI>
	</UL>

	<LI><A HREF="#author">AUTHOR</A></LI>
</UL>
<!-- INDEX END -->

<HR>
<P>
<H1><A NAME="name">NAME</A></H1>
<P>ePortal::PageView - Custom home page of ePortal.</P>
<P>
<HR>
<H1><A NAME="synopsis">SYNOPSIS</A></H1>
<P>There are 3 types of PageView:</P>
<UL>
<LI>
<STRONG>user</STRONG> - personal home page of a registered user
<P></P>
<LI>
<STRONG>default</STRONG> - only one PageView may be default. This is default home page of
a site
<P></P>
<LI>
<STRONG>template</STRONG> - There may be many templates. They are used when user create
new personal home page.
<P></P></UL>
<P>
<HR>
<H1><A NAME="methods">METHODS</A></H1>
<P>
<H2><A NAME="restore%28id%29"><CODE>restore(id)</CODE></A></H2>
<P>Restore a PageView.</P>
<P><STRONG>id</STRONG> is 'default' - find unique default PageView</P>
<P><STRONG>id</STRONG> is Number - restore a PageView with this ID</P>
<P>Else use some magic to find desired PageView. This is the rules:</P>
<P>- Anonymous user always sees default PageView.</P>
<P>- If user is registered and has 'DefaultPageView' then restore it. If it
fails then restore default PageView. Once a day restore default PageView
for the user to see some global news ;-)</P>
<P>- Else or if something fails then restore default PageView.</P>
<P>This function returns 1 on success or 0 on error.</P>
<P>
<H2><A NAME="restore_all_templates%28%29"><CODE>restore_all_templates()</CODE></A></H2>
<P>Does restore_where(pvtype = template).</P>
<P>
<H2><A NAME="restore_all_for_user%28username%29"><CODE>restore_all_for_user(username)</CODE></A></H2>
<P>Does <CODE>restore_where(...)</CODE> for all PageView available to user (both default
and user type)</P>
<P><STRONG>username</STRONG> is default to current user name</P>
<P>
<H2><A NAME="columnscount%28%29"><CODE>ColumnsCount()</CODE></A></H2>
<P>Return a number of columns in the current PageView.</P>
<P>
<H2><A NAME="columnswidthpercent%28%29"><CODE>ColumnsWidthPercent()</CODE></A></H2>
<P>Returns array of numbers with width in percent of PageView's columns.
Narrow column counts as 1, wide column - as 2. For two-column PageView
(N:W) result would be (33,66).</P>
<P><EM>Note</EM>: The percent sign is not included after numbers.</P>
<P>
<H2><A NAME="availablesections%28column_number%29"><CODE>AvailableSections(column_number)</CODE></A></H2>
<P>Returns array (\@values, \%labels) with available sections for addition to
the column. References returned are ready to pass to CGI::popup_menu(...)</P>
<P><STRONG>column_number</STRONG> is number of desired column in PageView.</P>
<P>
<H2><A NAME="get_usersection%28%24column%29"><CODE>get_UserSection($column)</CODE></A></H2>
<P>Does restore_where(for the column) on ePortal::UserSection object.</P>
<P>If $column is undef then all UserSection (for all columns) are selected.
This is the same as call to children().</P>
<P>Returns ePortal::UserSection object ready to restore_next().</P>
<P>
<H2><A NAME="copyfrom%28%24template_id%29"><CODE>CopyFrom($template_id)</CODE></A></H2>
<P>Copy PageView object from denoted by $template_id to current one. The
pvtype attribute is changed to 'user'. Also copies all daughter UserSection
objects.</P>
<P>Returns: 1 on success.</P>
<P>
<H2><A NAME="setdefaultpageview%28%24new_id%29"><CODE>SetDefaultPageView($new_id)</CODE></A></H2>
<P>This function is mean only for registered users. <STRONG>new_id</STRONG> is stored in
user's configuration and used when next call to PageView-&gt;restore().</P>
<P>
<H2><A NAME="handle_request%28%29"><CODE>handle_request()</CODE></A></H2>
<P>Get and process URL parameters to add, remove, modify a section. Parameters
are:</P>
<P><STRONG>ps</STRONG> - PageSection ID</P>
<P><STRONG>us</STRONG> - UserSection ID</P>
<P><STRONG>colnum</STRONG> - column number</P>
<P><STRONG>addsection</STRONG> - if true then add new section <EM>ps</EM> to column <EM>colnum</EM></P>
<P><STRONG>removesection</STRONG> - if true then remove section <EM>us</EM></P>
<P><STRONG>min</STRONG> - if true then minimize section <EM>us</EM></P>
<P><STRONG>restore</STRONG> - if true then restore section <EM>us</EM> to normal size</P>
<P>
<HR>
<H1><A NAME="author">AUTHOR</A></H1>
<P>Sergey Rusakov, &lt;<A HREF="mailto:rusakov_sa@users.sourceforge.net">rusakov_sa@users.sourceforge.net</A>&gt;</P>

</BODY>

</HTML>
